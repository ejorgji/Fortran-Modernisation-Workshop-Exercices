var tipuesearch = {"pages":[{"text":"1D heat equation Note Fortran Modernisation Workshp 27/11/2018 Bug Distribution of heat exercices Developer Info E Jorgji","tags":"home","loc":"index.html","title":" 1D heat equation "},{"text":"This file depends on sourcefile~~solver_mod.f90~~EfferentGraph sourcefile~solver_mod.f90 Solver_mod.f90 sourcefile~types_mod.f90 Types_mod.f90 sourcefile~solver_mod.f90->sourcefile~types_mod.f90 sourcefile~rhs_mod.f90 RHS_mod.f90 sourcefile~solver_mod.f90->sourcefile~rhs_mod.f90 sourcefile~rhs_mod.f90->sourcefile~types_mod.f90 Help × Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\n    is dependent upon another if the latter must be compiled before the former\n    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Files dependent on this one sourcefile~~solver_mod.f90~~AfferentGraph sourcefile~solver_mod.f90 Solver_mod.f90 sourcefile~fd1d_heat_explicit.f90 fd1d_heat_explicit.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~solver_mod.f90 Help × Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\n    is dependent upon another if the latter must be compiled before the former\n    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Modules Solver_mod Source Code Solver_mod.f90 Source Code !> this module provides the Solver module Solver_mod use , intrinsic :: iso_fortran_env use :: types_mod , only : dp use :: rhs_mod implicit none ! everything is public unless otherwise stated public contains !> Solver subroutine subroutine fd1d_heat_explicit ( x , t , dt , cfl , h , h_new ) implicit none !> calculated CFL number real ( kind = dp ), intent ( in ) :: cfl real ( kind = dp ), intent ( in ) :: dt !> input heat data real ( kind = dp ), dimension (:), intent ( in ) :: h !> output heat data rreal ( kind = dp ), dimension (:), intent ( out ) :: h_new integer :: j real ( kind = dp ), intent ( in ) :: t real ( kind = dp ), dimension (:), intent ( in ) :: x real ( kind = dp ), dimension (:) :: f ( size ( x )) do j = 1 , size ( x ) f ( j ) = func ( j , x ) end do h_new ( 1 ) = 0.0e+00_dp do j = 2 , size ( x ) - 1 h_new ( j ) = h ( j ) + dt * f ( j ) + cfl * ( h ( j - 1 ) - 2.0e+00_dp * h ( j ) + h ( j + 1 )) end do ! set the boundary conditions again h_new ( 1 ) = 9 0.0e+00_dp h_new ( size ( x )) = 7 0.0e+00_dp end subroutine end module Solver_mod","tags":"","loc":"sourcefile/solver_mod.f90.html","title":"Solver_mod.f90 – 1D heat equation"},{"text":"This file depends on sourcefile~~io_mod.f90~~EfferentGraph sourcefile~io_mod.f90 IO_mod.f90 sourcefile~types_mod.f90 Types_mod.f90 sourcefile~io_mod.f90->sourcefile~types_mod.f90 Help × Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\n    is dependent upon another if the latter must be compiled before the former\n    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Files dependent on this one sourcefile~~io_mod.f90~~AfferentGraph sourcefile~io_mod.f90 IO_mod.f90 sourcefile~fd1d_heat_explicit.f90 fd1d_heat_explicit.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~io_mod.f90 Help × Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\n    is dependent upon another if the latter must be compiled before the former\n    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Modules IO_mod Source Code IO_mod.f90 Source Code !> this module realises In/Out operations module IO_mod use , intrinsic :: iso_fortran_env use :: types_mod , only : dp implicit none ! everything is public unless otherwise stated public contains subroutine r8mat_write ( output_filename , table ) implicit none integer :: j !> output file name character ( len =* ), intent ( in ) :: output_filename integer :: output_unit_id character ( len = 30 ) :: string !> heat matrix real ( kind = dp ), dimension (:,:), intent ( in ) :: table integer :: m integer :: n m = size ( table (:, :), 1 ) n = size ( table (:, :), 2 ) output_unit_id = 10 open ( unit = output_unit_id , file = output_filename , status = 'replace' ) write ( string , '(a1,i8,a1,i8,a1,i8,a1)' ) '(' , m , 'g' , 24 , '.' , 16 , ')' do j = 1 , n write ( output_unit_id , string ) table ( 1 : m , j ) end do close ( unit = output_unit_id ) end subroutine !> linear space vector subroutine r8vec_linspace ( a_first , a_last , a ) implicit none real ( kind = dp ), dimension (:), intent ( out ) :: a real ( kind = dp ), intent ( in ) :: a_first real ( kind = dp ), intent ( in ) :: a_last integer :: i integer :: n n = size ( a (:) ) do i = 1 , n a ( i ) = ( real ( n - i , kind = dp ) * a_first + real ( i - 1 , kind = dp ) * a_last ) / & real ( n - 1 , kind = dp ) end do end subroutine !> write vector subroutine r8vec_write ( output_filename , x ) implicit none integer :: j character ( len =* ), intent ( in ) :: output_filename integer :: output_unit_id real ( kind = dp ), dimension (:), intent ( in ) :: x integer :: n n = size ( x (:) ) output_unit_id = 11 open ( unit = output_unit_id , file = output_filename , status = 'replace' ) do j = 1 , n write ( output_unit_id , '(2x,g24.16)' ) x ( j ) end do close ( unit = output_unit_id ) end subroutine end module IO_mod","tags":"","loc":"sourcefile/io_mod.f90.html","title":"IO_mod.f90 – 1D heat equation"},{"text":"This file depends on sourcefile~~fd1d_heat_explicit.f90~~EfferentGraph sourcefile~fd1d_heat_explicit.f90 fd1d_heat_explicit.f90 sourcefile~io_mod.f90 IO_mod.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~io_mod.f90 sourcefile~types_mod.f90 Types_mod.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~types_mod.f90 sourcefile~rhs_mod.f90 RHS_mod.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~rhs_mod.f90 sourcefile~cfl_mod.f90 CFL_mod.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~cfl_mod.f90 sourcefile~solver_mod.f90 Solver_mod.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~solver_mod.f90 sourcefile~io_mod.f90->sourcefile~types_mod.f90 sourcefile~rhs_mod.f90->sourcefile~types_mod.f90 sourcefile~cfl_mod.f90->sourcefile~types_mod.f90 sourcefile~solver_mod.f90->sourcefile~types_mod.f90 sourcefile~solver_mod.f90->sourcefile~rhs_mod.f90 Help × Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\n    is dependent upon another if the latter must be compiled before the former\n    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Programs fd1d_heat_explicit_prb Source Code fd1d_heat_explicit.f90 Source Code !> <E Jorgji>, <CEA IT Engineer> !> Solves the one dimensional heat diffusion equation !>  \\frac{\\partial H}{\\partial t} !> - \\kappa\\frac{\\partial&#94;{2} H}{\\partial x&#94;{2}} = f(x)  program fd1d_heat_explicit_prb use :: types_mod , only : dp use :: rhs_mod use :: cfl_mod use :: io_mod use :: solver_mod implicit none integer , parameter :: T_NUM = 201 integer , parameter :: X_NUM = 21 real ( kind = dp ) :: cfl real ( kind = dp ) :: dt !  real (kind=dp) :: h(x_num) real ( kind = dp ), dimension (:), allocatable :: h integer :: ierr_h character ( len = 120 ) :: msg_h !  real (kind=dp) :: h_new(x_num) real ( kind = dp ), dimension (:), allocatable :: h_new integer :: ierr_h_new character ( len = 120 ) :: msg_h_new !  real (kind=dp) :: hmat(x_num, t_num) real ( kind = dp ), dimension (:,:), allocatable :: hmat integer :: ierr_hmat character ( len = 120 ) :: msg_hmat !  real (kind=dp) :: t(t_num) real ( kind = dp ), dimension (:), allocatable :: t integer :: ierr_t character ( len = 120 ) :: msg_t !  real (kind=dp) :: x(x_num) real ( kind = dp ), dimension (:), allocatable :: x integer :: ierr_x character ( len = 120 ) :: msg_x integer :: i integer :: j real ( kind = dp ) :: k real ( kind = dp ) :: t_max real ( kind = dp ) :: t_min real ( kind = dp ) :: x_max real ( kind = dp ) :: x_min allocate ( h ( 1 : x_num ), stat = ierr_h , errmsg = msg_h ) if ( ierr_h /= 0 ) then print * , msg_h endif allocate ( h_new ( 1 : x_num ), stat = ierr_h_new , errmsg = msg_h_new ) if ( ierr_h_new /= 0 ) then print * , msg_h_new endif ! the \"matrix\" stores all x-values for all t-values ! remember Fortran is column major, meaning that rows are contiguous allocate ( hmat ( 1 : x_num , 1 : t_num ), stat = ierr_hmat , errmsg = msg_hmat ) if ( ierr_hmat /= 0 ) then print * , msg_hmat endif allocate ( t ( 1 : x_num ), stat = ierr_t , errmsg = msg_t ) if ( ierr_t /= 0 ) then print * , msg_t endif allocate ( x ( 1 : x_num ), stat = ierr_x , errmsg = msg_x ) if ( ierr_x /= 0 ) then print * , msg_x endif write ( * , '(a)' ) ' ' write ( * , '(a)' ) 'FD1D_HEAT_EXPLICIT_PRB:' write ( * , '(a)' ) '  FORTRAN77 version.' write ( * , '(a)' ) '  Test the FD1D_HEAT_EXPLICIT library.' write ( * , '(a)' ) ' ' write ( * , '(a)' ) 'FD1D_HEAT_EXPLICIT_PRB:' write ( * , '(a)' ) '  Normal end of execution.' write ( * , '(a)' ) ' ' write ( * , '(a)' ) ' ' write ( * , '(a)' ) 'FD1D_HEAT_EXPLICIT_TEST01:' write ( * , '(a)' ) '  Compute an approximate solution to the time-dependent' write ( * , '(a)' ) '  one dimensional heat equation:' write ( * , '(a)' ) ' ' write ( * , '(a)' ) '    dH/dt - K * d2H/dx2 = f(x,t)' write ( * , '(a)' ) ' ' write ( * , '(a)' ) '  Run a simple test case.' ! heat coefficient k = 0.002e+00_dp ! the x-range values x_min = 0.0e+00_dp x_max = 1.0e+00_dp ! x_num is the number of intervals in the x-direction call r8vec_linspace ( x_min , x_max , x ) ! the t-range values. integrate from t_min to t_max t_min = 0.0e+00_dp t_max = 8 0.0e+00_dp ! t_num is the number of intervals in the t-direction dt = ( t_max - t_min ) / real ( t_num - 1 , kind = dp ) call r8vec_linspace ( t_min , t_max , t ) ! get the CFL coefficient call fd1d_heat_explicit_cfl ( k , t_num , t_min , t_max , x_num , x_min , x_max , & cfl ) if ( 0.5e+00_dp <= cfl ) then write ( * , '(a)' ) ' ' write ( * , '(a)' ) 'FD1D_HEAT_EXPLICIT_CFL - Fatal error!' write ( * , '(a)' ) '  CFL condition failed.' write ( * , '(a)' ) '  0.5 <= K * dT / dX / dX = CFL.' stop end if ! set the initial condition do j = 1 , x_num h ( j ) = 5 0.0e+00_dp end do ! set the bounday condition h ( 1 ) = 9 0.0e+00_dp h ( x_num ) = 7 0.0e+00_dp ! initialise the matrix to the initial condition do i = 1 , x_num hmat ( i , 1 ) = h ( i ) end do ! the main time integration loop do j = 2 , t_num call fd1d_heat_explicit ( x , t ( j - 1 ), dt , cfl , h , h_new ) do i = 1 , x_num hmat ( i , j ) = h_new ( i ) h ( i ) = h_new ( i ) end do end do ! write data to files call r8mat_write ( 'h_test01.txt' , hmat ) call r8vec_write ( 't_test01.txt' , t ) call r8vec_write ( 'x_test01.txt' , x ) ! deallocate deallocate ( h , stat = ierr_h ) deallocate ( h_new , stat = ierr_h_new ) deallocate ( hmat , stat = ierr_hmat ) deallocate ( t , stat = ierr_t ) deallocate ( x , stat = ierr_x ) contains end program","tags":"","loc":"sourcefile/fd1d_heat_explicit.f90.html","title":"fd1d_heat_explicit.f90 – 1D heat equation"},{"text":"This file depends on sourcefile~~rhs_mod.f90~~EfferentGraph sourcefile~rhs_mod.f90 RHS_mod.f90 sourcefile~types_mod.f90 Types_mod.f90 sourcefile~rhs_mod.f90->sourcefile~types_mod.f90 Help × Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\n    is dependent upon another if the latter must be compiled before the former\n    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Files dependent on this one sourcefile~~rhs_mod.f90~~AfferentGraph sourcefile~rhs_mod.f90 RHS_mod.f90 sourcefile~fd1d_heat_explicit.f90 fd1d_heat_explicit.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~rhs_mod.f90 sourcefile~solver_mod.f90 Solver_mod.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~solver_mod.f90 sourcefile~solver_mod.f90->sourcefile~rhs_mod.f90 Help × Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\n    is dependent upon another if the latter must be compiled before the former\n    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Modules RHS_mod Source Code RHS_mod.f90 Source Code !> this module calculates the RHS number module RHS_mod use , intrinsic :: iso_fortran_env use :: types_mod , only : dp implicit none ! everything is public unless otherwise stated public contains !> calculates the RHS number function func ( j , x ) result ( d ) implicit none integer , intent ( in ) :: j real ( kind = dp ) :: d real ( kind = dp ), dimension (:), intent ( in ) :: x d = 0.0e+00_dp end function end module RHS_mod","tags":"","loc":"sourcefile/rhs_mod.f90.html","title":"RHS_mod.f90 – 1D heat equation"},{"text":"This file depends on sourcefile~~cfl_mod.f90~~EfferentGraph sourcefile~cfl_mod.f90 CFL_mod.f90 sourcefile~types_mod.f90 Types_mod.f90 sourcefile~cfl_mod.f90->sourcefile~types_mod.f90 Help × Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\n    is dependent upon another if the latter must be compiled before the former\n    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Files dependent on this one sourcefile~~cfl_mod.f90~~AfferentGraph sourcefile~cfl_mod.f90 CFL_mod.f90 sourcefile~fd1d_heat_explicit.f90 fd1d_heat_explicit.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~cfl_mod.f90 Help × Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\n    is dependent upon another if the latter must be compiled before the former\n    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Modules CFL_mod Source Code CFL_mod.f90 Source Code !> this module calculates the CFL number module CFL_mod use , intrinsic :: iso_fortran_env use :: types_mod , only : dp implicit none ! everything is public unless otherwise stated public contains !> calculates the CFL number !>  \\text{CFL} = \\kappa\\frac{\\Delta t}{\\Delta x&#94;2}  subroutine fd1d_heat_explicit_cfl ( k , t_num , t_min , t_max , x_num , x_min , & x_max , cfl ) implicit none !> calculated CFL number real ( kind = dp ), intent ( out ) :: cfl real ( kind = dp ) :: dx real ( kind = dp ) :: dt !> the heat constant  \\kappa  real ( kind = dp ), intent ( in ) :: k !> t_max upper bound of t-axis real ( kind = dp ), intent ( in ) :: t_max !> lower bound of t-axis real ( kind = dp ), intent ( in ) :: t_min !> number of intervals in t-axis integer , intent ( in ) :: t_num !> upper bound of x-axis real ( kind = dp ), intent ( in ) :: x_max !> x_min lower bound of x-axis real ( kind = dp ), intent ( in ) :: x_min !> number of intervals in x-axis integer , intent ( in ) :: x_num dx = ( x_max - x_min ) / real ( x_num - 1 , kind = dp ) dt = ( t_max - t_min ) / real ( t_num - 1 , kind = dp ) cfl = k * dt / dx / dx write ( * , '(a)' ) ' ' write ( * , '(a,g14.6)' ) '  CFL stability criterion value = ' , cfl end subroutine end module CFL_mod","tags":"","loc":"sourcefile/cfl_mod.f90.html","title":"CFL_mod.f90 – 1D heat equation"},{"text":"Files dependent on this one sourcefile~~types_mod.f90~~AfferentGraph sourcefile~types_mod.f90 Types_mod.f90 sourcefile~io_mod.f90 IO_mod.f90 sourcefile~io_mod.f90->sourcefile~types_mod.f90 sourcefile~rhs_mod.f90 RHS_mod.f90 sourcefile~rhs_mod.f90->sourcefile~types_mod.f90 sourcefile~fd1d_heat_explicit.f90 fd1d_heat_explicit.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~types_mod.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~io_mod.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~rhs_mod.f90 sourcefile~cfl_mod.f90 CFL_mod.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~cfl_mod.f90 sourcefile~solver_mod.f90 Solver_mod.f90 sourcefile~fd1d_heat_explicit.f90->sourcefile~solver_mod.f90 sourcefile~cfl_mod.f90->sourcefile~types_mod.f90 sourcefile~solver_mod.f90->sourcefile~types_mod.f90 sourcefile~solver_mod.f90->sourcefile~rhs_mod.f90 Help × Graph Key Nodes of different colours represent the following: Graph Key Source File Source File This Page's Entity This Page's Entity Solid arrows point from a file to a file which it depends on. A file\n    is dependent upon another if the latter must be compiled before the former\n    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Modules Types_mod Source Code Types_mod.f90 Source Code !> this module provides the Types module Types_mod use , intrinsic :: iso_fortran_env implicit none ! everything is private unless otherwise stated private public :: SP , DP integer , parameter :: SP = REAL32 integer , parameter :: DP = REAL64 integer , parameter :: SI = INT32 integer , parameter :: DI = INT64 end module Types_mod","tags":"","loc":"sourcefile/types_mod.f90.html","title":"Types_mod.f90 – 1D heat equation"},{"text":"public subroutine fd1d_heat_explicit(x, t, dt, cfl, h, h_new) Solver subroutine\n output heat data Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in), dimension(:) :: x real(kind=dp), intent(in) :: t real(kind=dp), intent(in) :: dt real(kind=dp), intent(in) :: cfl calculated CFL number real(kind=dp), intent(in), dimension(:) :: h input heat data real :: h_new Calls proc~~fd1d_heat_explicit~~CallsGraph proc~fd1d_heat_explicit fd1d_heat_explicit proc~func func proc~fd1d_heat_explicit->proc~func rreal rreal proc~fd1d_heat_explicit->rreal Help × Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \n    arrows point from an interface to procedures which implement that interface.\n    This could include the module procedures in a generic interface or the\n    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents None","tags":"","loc":"proc/fd1d_heat_explicit.html","title":"fd1d_heat_explicit – 1D heat equation"},{"text":"public subroutine r8mat_write(output_filename, table) Arguments Type Intent Optional Attributes Name character(len=*), intent(in) :: output_filename output file name real(kind=dp), intent(in), dimension(:,:) :: table heat matrix Called by proc~~r8mat_write~~CalledByGraph proc~r8mat_write r8mat_write program~fd1d_heat_explicit_prb fd1d_heat_explicit_prb program~fd1d_heat_explicit_prb->proc~r8mat_write Help × Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \n    arrows point from an interface to procedures which implement that interface.\n    This could include the module procedures in a generic interface or the\n    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents None","tags":"","loc":"proc/r8mat_write.html","title":"r8mat_write – 1D heat equation"},{"text":"public subroutine r8vec_linspace(a_first, a_last, a) linear space vector Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: a_first real(kind=dp), intent(in) :: a_last real(kind=dp), intent(out), dimension(:) :: a Called by proc~~r8vec_linspace~~CalledByGraph proc~r8vec_linspace r8vec_linspace program~fd1d_heat_explicit_prb fd1d_heat_explicit_prb program~fd1d_heat_explicit_prb->proc~r8vec_linspace Help × Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \n    arrows point from an interface to procedures which implement that interface.\n    This could include the module procedures in a generic interface or the\n    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents None","tags":"","loc":"proc/r8vec_linspace.html","title":"r8vec_linspace – 1D heat equation"},{"text":"public subroutine r8vec_write(output_filename, x) write vector Arguments Type Intent Optional Attributes Name character(len=*), intent(in) :: output_filename real(kind=dp), intent(in), dimension(:) :: x Called by proc~~r8vec_write~~CalledByGraph proc~r8vec_write r8vec_write program~fd1d_heat_explicit_prb fd1d_heat_explicit_prb program~fd1d_heat_explicit_prb->proc~r8vec_write Help × Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \n    arrows point from an interface to procedures which implement that interface.\n    This could include the module procedures in a generic interface or the\n    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents None","tags":"","loc":"proc/r8vec_write.html","title":"r8vec_write – 1D heat equation"},{"text":"public function func(j, x) result(d) calculates the RHS number Arguments Type Intent Optional Attributes Name integer, intent(in) :: j real(kind=dp), intent(in), dimension(:) :: x Return Value real(kind=dp) Called by proc~~func~~CalledByGraph proc~func func proc~fd1d_heat_explicit fd1d_heat_explicit proc~fd1d_heat_explicit->proc~func Help × Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \n    arrows point from an interface to procedures which implement that interface.\n    This could include the module procedures in a generic interface or the\n    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents None","tags":"","loc":"proc/func.html","title":"func – 1D heat equation"},{"text":"public subroutine fd1d_heat_explicit_cfl(k, t_num, t_min, t_max, x_num, x_min, x_max, cfl) calculates the CFL number \\text{CFL} = \\kappa\\frac{\\Delta t}{\\Delta x&#94;2} Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: k the heat constant \\kappa integer, intent(in) :: t_num number of intervals in t-axis real(kind=dp), intent(in) :: t_min lower bound of t-axis real(kind=dp), intent(in) :: t_max t_max upper bound of t-axis integer, intent(in) :: x_num number of intervals in x-axis real(kind=dp), intent(in) :: x_min x_min lower bound of x-axis real(kind=dp), intent(in) :: x_max upper bound of x-axis real(kind=dp), intent(out) :: cfl calculated CFL number Called by proc~~fd1d_heat_explicit_cfl~~CalledByGraph proc~fd1d_heat_explicit_cfl fd1d_heat_explicit_cfl program~fd1d_heat_explicit_prb fd1d_heat_explicit_prb program~fd1d_heat_explicit_prb->proc~fd1d_heat_explicit_cfl Help × Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \n    arrows point from an interface to procedures which implement that interface.\n    This could include the module procedures in a generic interface or the\n    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents None","tags":"","loc":"proc/fd1d_heat_explicit_cfl.html","title":"fd1d_heat_explicit_cfl – 1D heat equation"},{"text":"this module provides the Solver Uses iso_fortran_env Types_mod RHS_mod module~~solver_mod~~UsesGraph module~solver_mod Solver_mod module~types_mod Types_mod module~solver_mod->module~types_mod iso_fortran_env iso_fortran_env module~solver_mod->iso_fortran_env module~rhs_mod RHS_mod module~solver_mod->module~rhs_mod module~types_mod->iso_fortran_env module~rhs_mod->module~types_mod module~rhs_mod->iso_fortran_env Help × Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\n    descended from. Dashed arrows point from a module or program unit to \n    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Used by module~~solver_mod~~UsedByGraph module~solver_mod Solver_mod program~fd1d_heat_explicit_prb fd1d_heat_explicit_prb program~fd1d_heat_explicit_prb->module~solver_mod Help × Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\n    descended from. Dashed arrows point from a module or program unit to \n    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Subroutines fd1d_heat_explicit Subroutines public subroutine fd1d_heat_explicit (x, t, dt, cfl, h, h_new) Solver subroutine\n output heat data Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in), dimension(:) :: x real(kind=dp), intent(in) :: t real(kind=dp), intent(in) :: dt real(kind=dp), intent(in) :: cfl calculated CFL number real(kind=dp), intent(in), dimension(:) :: h input heat data real :: h_new","tags":"","loc":"module/solver_mod.html","title":"Solver_mod – 1D heat equation"},{"text":"this module realises In/Out operations Uses iso_fortran_env Types_mod module~~io_mod~~UsesGraph module~io_mod IO_mod module~types_mod Types_mod module~io_mod->module~types_mod iso_fortran_env iso_fortran_env module~io_mod->iso_fortran_env module~types_mod->iso_fortran_env Help × Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\n    descended from. Dashed arrows point from a module or program unit to \n    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Used by module~~io_mod~~UsedByGraph module~io_mod IO_mod program~fd1d_heat_explicit_prb fd1d_heat_explicit_prb program~fd1d_heat_explicit_prb->module~io_mod Help × Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\n    descended from. Dashed arrows point from a module or program unit to \n    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Subroutines r8mat_write r8vec_linspace r8vec_write Subroutines public subroutine r8mat_write (output_filename, table) Arguments Type Intent Optional Attributes Name character(len=*), intent(in) :: output_filename output file name real(kind=dp), intent(in), dimension(:,:) :: table heat matrix public subroutine r8vec_linspace (a_first, a_last, a) linear space vector Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: a_first real(kind=dp), intent(in) :: a_last real(kind=dp), intent(out), dimension(:) :: a public subroutine r8vec_write (output_filename, x) write vector Arguments Type Intent Optional Attributes Name character(len=*), intent(in) :: output_filename real(kind=dp), intent(in), dimension(:) :: x","tags":"","loc":"module/io_mod.html","title":"IO_mod – 1D heat equation"},{"text":"this module calculates the RHS number Uses iso_fortran_env Types_mod module~~rhs_mod~~UsesGraph module~rhs_mod RHS_mod module~types_mod Types_mod module~rhs_mod->module~types_mod iso_fortran_env iso_fortran_env module~rhs_mod->iso_fortran_env module~types_mod->iso_fortran_env Help × Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\n    descended from. Dashed arrows point from a module or program unit to \n    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Used by module~~rhs_mod~~UsedByGraph module~rhs_mod RHS_mod program~fd1d_heat_explicit_prb fd1d_heat_explicit_prb program~fd1d_heat_explicit_prb->module~rhs_mod module~solver_mod Solver_mod program~fd1d_heat_explicit_prb->module~solver_mod module~solver_mod->module~rhs_mod Help × Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\n    descended from. Dashed arrows point from a module or program unit to \n    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Functions func Functions public function func (j, x) result(d) calculates the RHS number Arguments Type Intent Optional Attributes Name integer, intent(in) :: j real(kind=dp), intent(in), dimension(:) :: x Return Value real(kind=dp)","tags":"","loc":"module/rhs_mod.html","title":"RHS_mod – 1D heat equation"},{"text":"this module calculates the CFL number Uses iso_fortran_env Types_mod module~~cfl_mod~~UsesGraph module~cfl_mod CFL_mod module~types_mod Types_mod module~cfl_mod->module~types_mod iso_fortran_env iso_fortran_env module~cfl_mod->iso_fortran_env module~types_mod->iso_fortran_env Help × Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\n    descended from. Dashed arrows point from a module or program unit to \n    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Used by module~~cfl_mod~~UsedByGraph module~cfl_mod CFL_mod program~fd1d_heat_explicit_prb fd1d_heat_explicit_prb program~fd1d_heat_explicit_prb->module~cfl_mod Help × Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\n    descended from. Dashed arrows point from a module or program unit to \n    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Subroutines fd1d_heat_explicit_cfl Subroutines public subroutine fd1d_heat_explicit_cfl (k, t_num, t_min, t_max, x_num, x_min, x_max, cfl) calculates the CFL number \\text{CFL} = \\kappa\\frac{\\Delta t}{\\Delta x&#94;2} Arguments Type Intent Optional Attributes Name real(kind=dp), intent(in) :: k the heat constant \\kappa integer, intent(in) :: t_num number of intervals in t-axis real(kind=dp), intent(in) :: t_min lower bound of t-axis real(kind=dp), intent(in) :: t_max t_max upper bound of t-axis integer, intent(in) :: x_num number of intervals in x-axis real(kind=dp), intent(in) :: x_min x_min lower bound of x-axis real(kind=dp), intent(in) :: x_max upper bound of x-axis real(kind=dp), intent(out) :: cfl calculated CFL number","tags":"","loc":"module/cfl_mod.html","title":"CFL_mod – 1D heat equation"},{"text":"this module provides the Types Uses iso_fortran_env module~~types_mod~~UsesGraph module~types_mod Types_mod iso_fortran_env iso_fortran_env module~types_mod->iso_fortran_env Help × Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\n    descended from. Dashed arrows point from a module or program unit to \n    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Used by module~~types_mod~~UsedByGraph module~types_mod Types_mod module~rhs_mod RHS_mod module~rhs_mod->module~types_mod module~io_mod IO_mod module~io_mod->module~types_mod module~cfl_mod CFL_mod module~cfl_mod->module~types_mod program~fd1d_heat_explicit_prb fd1d_heat_explicit_prb program~fd1d_heat_explicit_prb->module~types_mod program~fd1d_heat_explicit_prb->module~rhs_mod program~fd1d_heat_explicit_prb->module~io_mod program~fd1d_heat_explicit_prb->module~cfl_mod module~solver_mod Solver_mod program~fd1d_heat_explicit_prb->module~solver_mod module~solver_mod->module~types_mod module~solver_mod->module~rhs_mod Help × Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\n    descended from. Dashed arrows point from a module or program unit to \n    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Variables SP DP SI DI Variables Type Visibility Attributes Name Initial integer, public, parameter :: SP = REAL32 integer, public, parameter :: DP = REAL64 integer, private, parameter :: SI = INT32 integer, private, parameter :: DI = INT64","tags":"","loc":"module/types_mod.html","title":"Types_mod – 1D heat equation"},{"text":"Uses Types_mod RHS_mod CFL_mod IO_mod Solver_mod program~~fd1d_heat_explicit_prb~~UsesGraph program~fd1d_heat_explicit_prb fd1d_heat_explicit_prb module~types_mod Types_mod program~fd1d_heat_explicit_prb->module~types_mod module~rhs_mod RHS_mod program~fd1d_heat_explicit_prb->module~rhs_mod module~io_mod IO_mod program~fd1d_heat_explicit_prb->module~io_mod module~cfl_mod CFL_mod program~fd1d_heat_explicit_prb->module~cfl_mod module~solver_mod Solver_mod program~fd1d_heat_explicit_prb->module~solver_mod iso_fortran_env iso_fortran_env module~types_mod->iso_fortran_env module~rhs_mod->module~types_mod module~rhs_mod->iso_fortran_env module~io_mod->module~types_mod module~io_mod->iso_fortran_env module~cfl_mod->module~types_mod module~cfl_mod->iso_fortran_env module~solver_mod->module~types_mod module~solver_mod->module~rhs_mod module~solver_mod->iso_fortran_env Help × Graph Key Nodes of different colours represent the following: Graph Key Module Module Submodule Submodule Subroutine Subroutine Function Function Program Program This Page's Entity This Page's Entity Solid arrows point from a submodule to the (sub)module which it is\n    descended from. Dashed arrows point from a module or program unit to \n    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. , Solves the one dimensional heat diffusion equation \\frac{\\partial H}{\\partial t} \n - \\kappa\\frac{\\partial&#94;{2} H}{\\partial x&#94;{2}} = f(x) Calls program~~fd1d_heat_explicit_prb~~CallsGraph program~fd1d_heat_explicit_prb fd1d_heat_explicit_prb proc~fd1d_heat_explicit_cfl fd1d_heat_explicit_cfl program~fd1d_heat_explicit_prb->proc~fd1d_heat_explicit_cfl proc~r8mat_write r8mat_write program~fd1d_heat_explicit_prb->proc~r8mat_write proc~r8vec_write r8vec_write program~fd1d_heat_explicit_prb->proc~r8vec_write proc~r8vec_linspace r8vec_linspace program~fd1d_heat_explicit_prb->proc~r8vec_linspace Help × Graph Key Nodes of different colours represent the following: Graph Key Subroutine Subroutine Function Function Interface Interface Unknown Procedure Type Unknown Procedure Type Program Program This Page's Entity This Page's Entity Solid arrows point from a procedure to one which it calls. Dashed \n    arrows point from an interface to procedures which implement that interface.\n    This could include the module procedures in a generic interface or the\n    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs. Contents Variables T_NUM X_NUM cfl dt h ierr_h msg_h h_new ierr_h_new msg_h_new hmat ierr_hmat msg_hmat t ierr_t msg_t x ierr_x msg_x i j k t_max t_min x_max x_min Variables Type Attributes Name Initial integer, parameter :: T_NUM = 201 integer, parameter :: X_NUM = 21 real(kind=dp) :: cfl real(kind=dp) :: dt real(kind=dp), dimension(:), allocatable :: h integer :: ierr_h character(len=120) :: msg_h real(kind=dp), dimension(:), allocatable :: h_new integer :: ierr_h_new character(len=120) :: msg_h_new real(kind=dp), dimension(:,:), allocatable :: hmat integer :: ierr_hmat character(len=120) :: msg_hmat real(kind=dp), dimension(:), allocatable :: t integer :: ierr_t character(len=120) :: msg_t real(kind=dp), dimension(:), allocatable :: x integer :: ierr_x character(len=120) :: msg_x integer :: i integer :: j real(kind=dp) :: k real(kind=dp) :: t_max real(kind=dp) :: t_min real(kind=dp) :: x_max real(kind=dp) :: x_min","tags":"","loc":"program/fd1d_heat_explicit_prb.html","title":"fd1d_heat_explicit_prb – 1D heat equation"}]}